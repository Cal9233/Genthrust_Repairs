import type { RepairOrder, Shop } from '../../../src/types';
import { vi } from 'vitest';

// Mock repair orders
export const mockRepairOrders: RepairOrder[] = [
  {
    id: 'row-1',
    roNumber: 'RO-001',
    dateMade: new Date('2024-01-15'),
    shopName: 'Test Shop A',
    partNumber: 'PART-123',
    serialNumber: 'SN-12345',
    partDescription: 'Test Hydraulic Pump',
    requiredWork: 'Repair and testing',
    dateDroppedOff: new Date('2024-01-20'),
    estimatedCost: 6000,
    finalCost: 5800,
    terms: 'Net 30',
    shopReferenceNumber: 'SHOP-REF-001',
    estimatedDeliveryDate: new Date('2024-02-15'),
    currentStatus: 'IN PROGRESS',
    currentStatusDate: new Date('2024-01-25'),
    genThrustStatus: 'Active',
    shopStatus: '',
    trackingNumber: '',
    lastDateUpdated: null,
    nextDateToUpdate: new Date('2024-02-01'),
    checked: '',
    notes: 'Test notes',
    statusHistory: [
      {
        status: 'RECEIVED',
        date: new Date('2024-01-20'),
        user: 'Test User',
        notes: 'Received from shop',
      },
      {
        status: 'IN PROGRESS',
        date: new Date('2024-01-25'),
        user: 'Test User',
        notes: 'Started repair work',
      },
    ],
    isOverdue: false,
    daysOverdue: 0,
  },
  {
    id: 'row-2',
    roNumber: 'RO-002',
    dateMade: new Date('2024-01-10'),
    shopName: 'Test Shop B',
    partNumber: 'PART-456',
    serialNumber: 'SN-67890',
    partDescription: 'Test Motor Assembly',
    requiredWork: 'Rebuild',
    dateDroppedOff: new Date('2024-01-15'),
    estimatedCost: 3000,
    finalCost: null,
    terms: 'Net 30',
    shopReferenceNumber: 'SHOP-REF-002',
    estimatedDeliveryDate: new Date('2024-01-20'),
    currentStatus: 'WAITING QUOTE',
    currentStatusDate: new Date('2024-01-15'),
    genThrustStatus: 'Pending',
    shopStatus: '',
    trackingNumber: '',
    lastDateUpdated: null,
    nextDateToUpdate: new Date('2024-01-18'),
    checked: '',
    notes: '',
    statusHistory: [
      {
        status: 'RECEIVED',
        date: new Date('2024-01-15'),
        user: 'Test User',
        notes: 'Initial receipt',
      },
    ],
    isOverdue: true,
    daysOverdue: 5,
  },
];

// Mock shops
export const mockShops: Shop[] = [
  {
    id: 'shop-1',
    customerNumber: 'CUST001',
    businessName: 'Test Shop A',
    shopName: 'Test Shop A',
    addressLine1: '123 Main St',
    addressLine2: '',
    addressLine3: '',
    addressLine4: '',
    city: 'Springfield',
    state: 'IL',
    zip: '62701',
    country: 'USA',
    phone: '555-0101',
    tollFree: '800-555-0101',
    fax: '555-0102',
    email: 'contact@testshopa.com',
    website: 'www.testshopa.com',
    contact: 'John Doe',
    contactName: 'John Doe',
    paymentTerms: 'NET 30',
    defaultTerms: 'NET 30',
    ilsCode: 'ILS001',
    lastSaleDate: new Date('2024-01-10'),
    ytdSales: 50000,
  },
  {
    id: 'shop-2',
    customerNumber: 'CUST002',
    businessName: 'Test Shop B',
    shopName: 'Test Shop B',
    addressLine1: '456 Elm St',
    addressLine2: '',
    addressLine3: '',
    addressLine4: '',
    city: 'Chicago',
    state: 'IL',
    zip: '60601',
    country: 'USA',
    phone: '555-0102',
    tollFree: '800-555-0102',
    fax: '555-0103',
    email: 'info@testshopb.com',
    website: 'www.testshopb.com',
    contact: 'Jane Smith',
    contactName: 'Jane Smith',
    paymentTerms: 'NET 45',
    defaultTerms: 'NET 45',
    ilsCode: 'ILS002',
    lastSaleDate: new Date('2024-01-15'),
    ytdSales: 75000,
  },
];

// Mock Excel service responses
export const mockExcelResponse = {
  values: mockRepairOrders.map((ro) => [
    ro.roNumber,
    ro.dateMade?.toISOString(),
    ro.shopName,
    ro.partNumber,
    ro.serialNumber,
    ro.partDescription,
    ro.requiredWork,
    ro.dateDroppedOff?.toISOString(),
    ro.estimatedCost,
    ro.finalCost,
    ro.terms,
    ro.shopReferenceNumber,
    ro.estimatedDeliveryDate?.toISOString(),
    ro.currentStatus,
    ro.currentStatusDate?.toISOString(),
    ro.genThrustStatus,
    ro.shopStatus,
    ro.trackingNumber,
    ro.notes,
    ro.lastDateUpdated?.toISOString(),
    ro.nextDateToUpdate?.toISOString(),
  ]),
};

// Mock Graph client
export const createMockGraphClient = () => ({
  api: vi.fn(() => ({
    get: vi.fn(),
    post: vi.fn(),
    patch: vi.fn(),
    delete: vi.fn(),
  })),
});
